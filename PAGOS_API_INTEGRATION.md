# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Pagos API (CF24Pay)

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### API Endpoint
- **URL**: `https://wallet.cf24pay.com/createorder`
- **Method**: POST
- **Content-Type**: application/json

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```typescript
const mkey = 1774;
const secret = 'gzcaz1b4_yhb9nl7f';
```

## üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ó–∞–ø—Ä–æ—Å–∞

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ü–æ–ª—è
```typescript
const requestParam = {
    first_name: string,      // –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    last_name: string,       // –§–∞–º–∏–ª–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    address: string,         // –ê–¥—Ä–µ—Å
    orderid: string,         // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–∫–∞–∑–∞ (timestamp)
    country: 'CO',           // –ö–æ–¥ —Å—Ç—Ä–∞–Ω—ã (–ö–æ–ª—É–º–±–∏—è)
    state: string,           // –®—Ç–∞—Ç/–¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç
    city: string,            // –ì–æ—Ä–æ–¥
    zip: string,             // –ü–æ—á—Ç–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å
    ip_address: string,      // IP –∞–¥—Ä–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    birth_date: string,      // –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è (DD/MM/YYYY)
    email: string,           // Email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    phone_no: string,        // –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (10 —Ü–∏—Ñ—Ä)
    amount: string,          // –°—É–º–º–∞ –¥–µ–ø–æ–∑–∏—Ç–∞
    currency: 'cop',         // –í–∞–ª—é—Ç–∞ (–∫–æ–ª—É–º–±–∏–π—Å–∫–∏–µ –ø–µ—Å–æ)
    tax_id: string          // –ù–∞–ª–æ–≥–æ–≤—ã–π ID
};
```

### –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ –£–º–æ–ª—á–∞–Ω–∏—é
```typescript
{
    first_name: 'kevin daniel',
    last_name: 'Diaz Narvaez',
    address: 'Calle 45 #18A-27',
    country: 'CO',
    state: 'co',
    city: 'Bogot√°',
    zip: '110111',
    ip_address: '186.168.118.183',
    birth_date: '15/03/1985',
    email: 'kevindanieldiazn@gmail.com',
    phone_no: '5330012345',
    currency: 'cop',
    tax_id: '1.024.567.890'
}
```

## üîê –°–∏—Å—Ç–µ–º–∞ –ü–æ–¥–ø–∏—Å–∏

### –ê–ª–≥–æ—Ä–∏—Ç–º –°–æ–∑–¥–∞–Ω–∏—è –ü–æ–¥–ø–∏—Å–∏
1. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –ø–æ –∫–ª—é—á–∞–º (–∞–ª—Ñ–∞–≤–∏—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫)
2. **–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–ø–∏—Å–∏**: `key1=value1:key2=value2:...`
3. **HMAC SHA256** —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º
4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏** –∫–∞–∫ `co_sign` –≤ –∑–∞–ø—Ä–æ—Å

### –ü—Ä–∏–º–µ—Ä –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏
```typescript
// –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–ª—é—á–µ–π
const sortedKeys = Object.keys(requestParam).sort();

// –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
const signString = sortedKeys
    .map(key => `${key}=${requestParam[key]}`)
    .join(':');

// –°–æ–∑–¥–∞–Ω–∏–µ HMAC SHA256 –ø–æ–¥–ø–∏—Å–∏
const cryptoKey = await crypto.subtle.importKey(
    'raw',
    encoder.encode(secret),
    { name: 'HMAC', hash: 'SHA-256' },
    false,
    ['sign']
);

const signature = await crypto.subtle.sign('HMAC', cryptoKey, encoder.encode(signString));
const signatureHex = Array.from(new Uint8Array(signature))
    .map(b => b.toString(16).padStart(2, '0'))
    .join('');
```

## üîÑ –ü–æ—Ç–æ–∫ –û–±—Ä–∞–±–æ—Ç–∫–∏

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –ü–æ–ª–µ–π
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (10 —Ü–∏—Ñ—Ä)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º—ã

### 2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –î–∞–Ω–Ω—ã—Ö
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è (YYYY-MM-DD ‚Üí DD/MM/YYYY)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ orderid (timestamp)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –ü–æ–¥–ø–∏—Å–∏
- ‚úÖ –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥–ø–∏—Å–∏
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HMAC SHA256

### 4. API –ó–∞–ø—Ä–æ—Å
- ‚úÖ POST –∑–∞–ø—Ä–æ—Å –∫ CF24Pay API
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ JSON –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–¥–ø–∏—Å—å—é

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –û—Ç–≤–µ—Ç–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ CF24Pay (payment_link + order_id)
- ‚úÖ –ü–æ–∫–∞–∑ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞ —É—Å–ø–µ—Ö–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ order_id –≤ localStorage
- ‚úÖ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

## üì§ –ó–∞–≥–æ–ª–æ–≤–∫–∏ –ó–∞–ø—Ä–æ—Å–∞
```typescript
{
    'Content-Type': 'application/json',
    'X-Request-Mkey': '1774'
}
```

## üì• –û–±—Ä–∞–±–æ—Ç–∫–∞ –û—Ç–≤–µ—Ç–∞

### –£—Å–ø–µ—à–Ω—ã–π –û—Ç–≤–µ—Ç (CF24Pay Format)
```json
{
    "payment_link": "https://wallet.cf24pay.com/cop/?chekout=...",
    "order_id": "cd7d3004-4579-4aa9-bd92-c92303e12fe4"
}
```

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –£—Å–ø–µ—à–Ω—ã–π –û—Ç–≤–µ—Ç
```json
{
    "success": true,
    "status": "success",
    "redirect_url": "https://payment.url",
    "order_id": "1234567890"
}
```

### –û—à–∏–±–∫–∞
```json
{
    "success": false,
    "error": "Error message",
    "code": "ERROR_CODE"
}
```

## üéØ –£—Å–ª–æ–≤–∏—è –ê–∫—Ç–∏–≤–∞—Ü–∏–∏

API –∑–∞–ø—Ä–æ—Å –∫ CF24Pay –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞:
- ‚úÖ –í—ã–±—Ä–∞–Ω –º–µ—Ç–æ–¥ –æ–ø–ª–∞—Ç—ã "Pagos"
- ‚úÖ –í—Å–µ –ø–æ–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
- ‚úÖ –°—É–º–º–∞ –±–æ–ª—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π

## üîß –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç:
- üìù –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- üìù –°—Ç—Ä–æ–∫—É –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
- üìù –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–æ–¥–ø–∏—Å—å
- üìù –û—Ç–≤–µ—Ç –æ—Ç API
- üìù –û—à–∏–±–∫–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ

## üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –§—É–Ω–∫—Ü–∏—è API –ó–∞–ø—Ä–æ—Å–∞
```typescript
const handlePagosPayment = async (amount: number) => {
    // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏
    // API –∑–∞–ø—Ä–æ—Å
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞
};
```

### –í—ã–∑–æ–≤ –∏–∑ handleDeposit
```typescript
if (selectedMethod === 'Pagos') {
    handlePagosPayment(amount);
} else {
    // –î—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã –æ–ø–ª–∞—Ç—ã
}
```

## ‚úÖ –°—Ç–∞—Ç—É—Å –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- ‚úÖ API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π –¥–æ–±–∞–≤–ª–µ–Ω–∞
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- ‚úÖ –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ
- ‚úÖ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–ª–∞—Ç–µ–∂–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
- ‚úÖ –ö–æ–¥ –±–µ–∑ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Pagos API –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!